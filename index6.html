<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="style6.css">
	<script src ="shadow_red.js"></script>
</head>
<body>
	<div class="death">You have died</div>
	<div class="gameover">GAME OVER</div>
	<script>
		var field = document.createElement("div");
		field.className = 'field';
		document.body.appendChild(field);
		var map = [[0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
				   [0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0],
				   [0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0],
				   [0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0],
				   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				   [0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,0],
				   [0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,0],
				   [0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0],
				   [1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,1,0,0,0,0,0,0,1,0,1,1,0,1,1,1,1,1],
				   [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
				   [1,1,1,1,1,0,1,1,0,1,0,0,0,0,0,0,1,0,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1],
				   [1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1],
				   [0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
				   [0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0],
				   [0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0],
				   [0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],
				   [1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,0,1,1],
				   [1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,0,1,1],
				   [0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0],
				   [0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0],
				   [0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0],
				   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		]
		var balls =[];
		for(i=0;i<map.length;i++){
			for(j=0;j<map.length;j++){
				var cell = document.createElement("div");
				var ball = document.createElement("div");
				ball.className = 'ball';
				if(map[i][j]==0){
					cell.className = 'empty';
					cell.appendChild(ball);
					ball.style.display = "block";
					balls.push(ball);
				}
				if(map[i][j]==1){
					cell.className = 'wall';
					balls.push('1');
				}
				field.appendChild(cell);
			}
		}			
		balls[0].style.display = "none";
		var pacman = document.createElement("div");
		pacman.className = 'pacman';
		field.appendChild(pacman);
		var coordinat_y = 0;
		var coordinat_x = 0;
		var key=0;
		var pacman_x=0;
		var pacman_y=0;	
		var score=0;
		var counter= document.createElement("div");
		counter.className = 'counter';
		counter.innerHTML = "SCORE: "+ 0;
		document.body.appendChild(counter);
		var health =document.createElement("div");
		health.className = 'health';
		document.body.appendChild(health);
		var hearts =[];
		for(i=0;i<3;i++){
			var heart = document.createElement("div");
			heart.className = 'heart';
			health.appendChild(heart);
			hearts.push(heart);
		}
		var death = document.querySelector('.death');
		var life = 3;
		function move(event){
			death.style.display = "none";
			if(life==0){
				return;
			}
			if(score==5920){
				alert("You are the champion");
				location.reload();
			}

			if(event.keyCode=='38'){
				if(key!=38){
					pacman.style.transform = "rotate(270deg)";
				}
				coordinat_y = +pacman.style.top.replace("px","");
				if(coordinat_y>0){
					if(map[pacman_y-1][pacman_x]==0){
						pacman.style.top=coordinat_y - 25 +"px";
						pacman_y = pacman_y - 1;
						if(balls[pacman_y*26+pacman_x].style.display == "block"){
							balls[pacman_y*26+pacman_x].style.display = "none";
							score=score+20;
						}	
					}
				}
			}
			if(event.keyCode=='40'){
				if(key!=40){
					pacman.style.transform = "rotate(90deg)"
				}
				coordinat_y = +pacman.style.top.replace("px","");
				if(coordinat_y<700){
					if(map[pacman_y+1][pacman_x]==0){
						pacman.style.top=coordinat_y + 25 +"px";
						pacman_y = pacman_y + 1;
						if(balls[pacman_y*26+pacman_x].style.display == "block"){
							balls[pacman_y*26+pacman_x].style.display = "none";
							score=score+20;
						}
					}
				}
			}
			if(event.keyCode=='37'){
				if(key!=37){
					pacman.style.transform = "rotate(180deg)"
				}
				coordinat_x = +pacman.style.left.replace("px","");
				if(coordinat_x>0){
					if(map[pacman_y][pacman_x-1]==0){
						pacman.style.left=coordinat_x - 25 +"px";
						pacman_x = pacman_x - 1;
						if(balls[pacman_y*26+pacman_x].style.display == "block"){
							balls[pacman_y*26+pacman_x].style.display = "none";
							score=score+20;
						}	
					}
				}
				if(coordinat_x==0 && pacman_y==13){
					pacman.style.left="625px";
					pacman_x = 25;
					balls[pacman_y*26+pacman_x].style.display = "none";
				}
			}
			if(event.keyCode=='39'){
				if(key!=39){
					pacman.style.transform = "rotate(360deg)"
				}
				coordinat_x = +pacman.style.left.replace("px","");
				if(coordinat_x<625){
					if(map[pacman_y][pacman_x+1]==0){
						pacman.style.left=coordinat_x + 25 +"px";
						pacman_x = pacman_x + 1;
						if(balls[pacman_y*26+pacman_x].style.display == "block"){
							balls[pacman_y*26+pacman_x].style.display = "none";
							score=score+20;
						}
					}
				}
				if(coordinat_x==625 && pacman_y==13){
					pacman.style.left="0px";
					pacman_x=0;
					balls[pacman_y*26+pacman_x].style.display = "none";
				}
			}
			key = event.keyCode;
			counter.innerHTML = "SCORE: "+ score;  		
		}
		console.log(score);
		window.addEventListener('keydown',move,false);
		var eating_flag = false;
		function eating(){
			if(!eating_flag){
				pacman.style.borderRight = "12.5px solid #F4B915";
				eating_flag = true;
			}
			else{
				pacman.style.borderRight = "12.5px solid transparent";
				eating_flag = false;
			}
		}
		var eatingId = setInterval(eating,250);
		var shadow = document.createElement("div");
		shadow.className = 'shadow';
		field.appendChild(shadow);
	</script>
</body>
</html>